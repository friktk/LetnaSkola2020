<!doctype html><html lang=sk class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Výučbový systém BT-car3"><link href=https://friktk.github.io/LetnaSkola2020/pr1/ rel=canonical><meta name=author content="Martin Húdik"><link rel="shortcut icon" href=../images/icon.png><meta name=generator content="mkdocs-1.1, mkdocs-material-5.1.5"><title>Príklad 1 „RGB_LED“ - BT-car3</title><link rel=stylesheet href=../assets/stylesheets/main.df84b5fe.min.css><link rel=stylesheet href=../assets/stylesheets/palette.8435c73a.min.css><meta name=theme-color content=#3f51b5><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../stylesheets/extra.css><link rel=stylesheet href=../stylesheets/w3.css></head> <body dir data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#prvy-krok class=md-skip> Preskočiť na obsah </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label> <a href=https://friktk.github.io/LetnaSkola2020/ title=BT-car3 class="md-header-nav__button md-logo" aria-label=BT-car3> <img src=../images/logo.svg alt=logo> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> BT-car3 </span> <span class="md-header-nav__topic md-ellipsis"> Príklad 1 „RGB_LED“ </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Hľadať placeholder=Hľadať autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/friktk/LetnaSkola2020.git title="Zobraziť repozitár" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> LetnaSkola 2020 </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class="md-tabs md-tabs--active" aria-label data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class="md-tabs__link md-tabs__link--active"> BT-car3 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://friktk.github.io/LetnaSkola2020/ title=BT-car3 class="md-nav__button md-logo" aria-label=BT-car3> <img src=../images/logo.svg alt=logo> </a> BT-car3 </label> <div class=md-nav__source> <a href=https://github.com/friktk/LetnaSkola2020.git title="Zobraziť repozitár" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> LetnaSkola 2020 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1 type=checkbox id=nav-1 checked> <label class=md-nav__link for=nav-1> BT-car3 <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=BT-car3 data-md-level=1> <label class=md-nav__title for=nav-1> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> BT-car3 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. title=Úvod class=md-nav__link> Úvod </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-2 type=checkbox id=nav-1-2 checked> <label class=md-nav__link for=nav-1-2> Príklady <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Príklady data-md-level=2> <label class=md-nav__title for=nav-1-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Príklady </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Príklad 1 „RGB_LED“ <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg> </span> </label> <a href=./ title="Príklad 1 „RGB_LED“" class="md-nav__link md-nav__link--active"> Príklad 1 „RGB_LED“ </a> <nav class="md-nav md-nav--secondary" aria-label=Obsah> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Obsah </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#prvy-krok class=md-nav__link> Prvý krok </a> </li> <li class=md-nav__item> <a href=#objektovy-pristup class=md-nav__link> Objektový prístup </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../pr2/ title="Príklad 2 „RGB_AKU“" class=md-nav__link> Príklad 2 „RGB_AKU“ </a> </li> <li class=md-nav__item> <a href=../pr3/ title="Príklad 3 „TLAČIDLO“" class=md-nav__link> Príklad 3 „TLAČIDLO“ </a> </li> <li class=md-nav__item> <a href=../pr4/ title="Príklad 4 „UART“" class=md-nav__link> Príklad 4 „UART“ </a> </li> <li class=md-nav__item> <a href=../pr5/ title="Príklad 5 „Fotoodpor“" class=md-nav__link> Príklad 5 „Fotoodpor“ </a> </li> <li class=md-nav__item> <a href=../pr6/ title="Prerušovací podsystém" class=md-nav__link> Prerušovací podsystém </a> </li> <li class=md-nav__item> <a href=../pr7.md title=PWM class=md-nav__link> PWM </a> </li> <li class=md-nav__item> <a href=https://github.com/friktk/LetnaSkola2020/archive/ulohy.zip title=Download class=md-nav__link> Download </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3 type=checkbox id=nav-1-3> <label class=md-nav__link for=nav-1-3> Cvičenia <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Cvičenia data-md-level=2> <label class=md-nav__title for=nav-1-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Cvičenia </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://github.com/friktk/LetnaSkola2020/archive/triedy_cvicenie.zip title=Knižnica class=md-nav__link> Knižnica </a> </li> <li class=md-nav__item> <a href=https://github.com/friktk/LetnaSkola2020/tree/priklady/schema title=Schémy class=md-nav__link> Schémy </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=Obsah> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Obsah </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#prvy-krok class=md-nav__link> Prvý krok </a> </li> <li class=md-nav__item> <a href=#objektovy-pristup class=md-nav__link> Objektový prístup </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>Príklad 1 „RGB_LED“</h1> <p><strong>Projekt AVR0</strong></p> <p>Venujme sa vývoju prvej, snáď najjednoduchšej aplikácie, v jazyku C++, ktorá bude využívať uvedený hlavičkový súbor. Vytvorme prvý projekt, ktorý bude periodicky zasvecovať farby na RGB LED dióde v poradí červená, zelená a modrá. Každá farba nech svieti 0,5s a potom sa rozsvieti nasledujúca. Tento proces sa bude opakovať donekonečna, až pokiaľ neodpojíme napájacie napätie. Pretože modul AVR-board je napájaný prostredníctvom programátora z USB portu počítača, bude fungovať až do odpojenia programátora. Na obrázku je uvedená časť schémy, z ktorej budeme vychádzať pri tvorbe projektu. </p> <p><img alt src=../images/sch_pr.jpg#75size></p> <p>AVR-board je napájaný prostredníctvom programátora z USB portu počítača, bude fungovať až do odpojenia programátora. Na obrázku je uvedená časť schémy, z ktorej budeme vychádzať pri tvorbe projektu. </p> <p>Všimnime si, že anódy svetelných diód sú pripojené na potenciál Ucc. Ak chceme, aby príslušná dióda sa zasvietila musíme jej katódu pripojiť na nižší potenciál ako Ucc-UF, kde UF predstavuje úbytok napätia na dióde v priepustnom smere. Tejto podmienke vyhovuje stav, pri ktorom na katódu diódy privedieme potenciál zodpovedajúci log. 0 (budem ho označovať L, na rozdiel od potenciálu H, ktorý zodpovedá log.1). Z uvedeného vyplýva, že ak chceme zasvietiť napr. modrú diódu musíme na vývod PD7 priviesť úroveň L a na PD4 - červená a PD2 - zelená úroveň H.</p> <h3 id=prvy-krok>Prvý krok<a class=headerlink href=#prvy-krok title="Permanent link">&para;</a></h3> <p>Aby to nebolo také jednoduché, je potrebné pred tým definovať, že vývody PD2, PD4 a PD7 budú v režime výstup. Toto vykonáme zápisom log.1 do registra smeru DDRD. Register DDRD sa nachádza vnútri obvodu a jeho obsah definuje režim činnosti brány D (PORTD). Preto prvý krok bude:</p> <div class=highlight><pre><span></span><code><span class=n>sbi</span><span class=p>(</span><span class=n>DDRD</span><span class=p>,</span><span class=n>LED_RED</span><span class=p>);</span>      <span class=c1>// nastavenie smeru vyvodu PD4</span>
<span class=n>sbi</span><span class=p>(</span><span class=n>DDRD</span><span class=p>,</span><span class=n>LED_GREEN</span><span class=p>);</span>    <span class=c1>// nastavenie smeru vyvodu PD2</span>
<span class=n>sbi</span><span class=p>(</span><span class=n>DDRD</span><span class=p>,</span><span class=n>LED_BLUE</span><span class=p>);</span>     <span class=c1>// PD7, nic sa nestane ak pouzijes aj PORTD7, DDRD7 </span>
</code></pre></div> <p>Týmto sme s využitím makra definovaného v hlavičkovom súbore do príslušných bitov registra smeru DDRD zapísali log.1. Takto sme ich definovali ako výstupné. Teraz už stačí zapísať do príslušných bitov výstupného registra (PORTD) hodnotu log.0 pre modrú farbu a log.1 pre ostatné.</p> <div class=highlight><pre><span></span><code><span class=n>sbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span><span class=n>LED_RED</span><span class=p>);</span>     <span class=c1>// nastavenie hodnoty vyvodu PD4</span>
<span class=n>sbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span><span class=n>LED_GREEN</span><span class=p>);</span>   <span class=c1>// PD2</span>
<span class=n>cbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span><span class=n>LED_BLUE</span><span class=p>);</span>    <span class=c1>// PD7 </span>
</code></pre></div> <p>Ak <code>main()</code> upravíme tak, ako je to uvedené nižšie, pričom sme projekt doplnili o hlavičkový súbor <code>BOARD_AVR.h</code>, potom po úspešnom kompilovaní a napálení obvodu ostane svietiť modrá dióda.</p> <div class=highlight><pre><span></span><code><span class=cm>/* AVR0.cpp</span>
<span class=cm> *</span>
<span class=cm> * Created: 21.2.2020 11:18:12</span>
<span class=cm> * Author : Juraj</span>
<span class=cm> */</span>

<span class=cp>#include</span> <span class=cpf>&quot;BOARD_AVR.h&quot;</span><span class=cp></span>

<span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
<span class=p>{</span>
    <span class=cm>/************************** nastavenie smeru vyvodov*****************/</span>
    <span class=n>sbi</span><span class=p>(</span><span class=n>DDRD</span><span class=p>,</span> <span class=n>LED_RED</span><span class=p>);</span>   <span class=c1>// nastavenie smeru vyvodu PD4</span>
    <span class=n>sbi</span><span class=p>(</span><span class=n>DDRD</span><span class=p>,</span> <span class=n>LED_GREEN</span><span class=p>);</span> <span class=c1>//PD2</span>
    <span class=n>sbi</span><span class=p>(</span><span class=n>DDRD</span><span class=p>,</span> <span class=n>LED_BLUE</span><span class=p>);</span>  <span class=c1>//PD7</span>
    <span class=cm>/************************** teraz zasvietime len modru*****************/</span>
    <span class=n>sbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span> <span class=n>LED_RED</span><span class=p>);</span>   <span class=c1>// nastavenie hodnoty vyvodu PD4</span>
    <span class=n>sbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span> <span class=n>LED_GREEN</span><span class=p>);</span> <span class=c1>//PD2</span>
    <span class=n>cbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span> <span class=n>LED_BLUE</span><span class=p>);</span>  <span class=c1>//PD7</span>

    <span class=k>while</span> <span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>{</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <div class="admonition question"> <p class=admonition-title>Ako doplním projekt o ďalší súbor?</p> <p>Postup je jednoduchý. V okne Explorer sa kurzorom nastavím na názov projektu. Stlačím pravé tlačidlo myši čím vyvolám okno s ponukou. Z ponúkaného zoznamu vyberieme “add” a IDP mi v nasledujúcom okne ponúkne ďalšie možnosti. Z nich vyberiem, tú ktorá mi vyhovuje. V našom prípade novú položku – “New Item” - ak súbor chceme vytvoriť. V prípade, že daný súbor už máme niekde v počítači zvolíme existujúcu položku - “Existing Item”. </p> <p>Pri novej položke sa mi objaví ďalšie okno s ponukou typu. V prípade hlavičkového súboru vyberieme “Include File”, vypíšeme meno a stlačíme tlačidlo “add”. V Exploreri si všimnite, že v projekte pribudol ďalší súbor s definovaným názvom a príponou *.h. Na ploche editačného okna sa objaví šablóna, do ktorej vypíšete svoj vlastný hlavičkový súbor.</p> <p>V prípade voľby “Existing Item” sa otvorí okno prehliadača, v ktorom nájdete a vyberiete požadovaný súbor a stlačíte tlačidlo “add”. Názov zvoleného súboru sa automaticky objaví v okne Explorer. Rozšírenie projektu o novú triedu, prípadne záložku či referenciu nebudem teraz popisovať. </p> </div> <p>Poznamenajme, že každá V/V brána obvodu má vyhradené tri registre s označením:</p> <ul> <li> <p><strong>DDRx</strong> obsah tohto registra určuje smer vývodu. Definuje či ho budete používať ako vstup alebo výstup.</p> </li> <li> <p><strong>PORTx</strong> obsah tohto registra definuje úroveň napätia na jeho výstupe (log.0 .. L, log.1 je H).</p> </li> <li> <p><strong>PINx</strong> nie je z hardvérového pohľadu register je to skôr pripojovacie miesto. Pomocou referencie na túto adresu môžete čítať úrovne napätí H/L privedené z okolia na tento vývod. Ak chcete ale nastaviť vývod na potrebnú úroveň musíte ho nastaviť ako výstupný a príslušnú logickú hodnotu log.0/log.1 zapísať do odpovedajúceho bitu registra PORTD. </p> </li> </ul> <div class="admonition note"> <p class=admonition-title>Zapamätajme si:</p> <p>Logická nula je interpretovaná úrovňou L. To znamená ak do príslušného bitu registra PORTD (napr. PD7) zapíšem log.0, pričom v registri smeru v bite DDRD7 je zapísaná log.1, teda vývod PD7 je v režime výstup, potom na vývode PD7 sa objaví úroveň napätia L. Samozrejme, napätie je rozdiel dvoch potenciálov, preto aj v tomto prípade je potrebné zvoliť referenčný potenciál. Tento sa nazýva signálová zem a v našom prípade je označený ako GND. Teda rozdiel napätia medzi potenciálom na vývode PD7 a potenciálom zeme - GND definuje či sa jedná o úroveň napätia L alebo H.</p> <p>Pre úplnosť uvediem jednoduché pravidlo pre obvody CMOS: </p> <ul> <li>ak je úroveň napätia menšia než 0.3Ucc potom budeme predpokladať, že sa jedná o úroveň L,</li> <li>ak úroveň napätia je väčšia než 0.7Ucc bude interpretovaná ako úroveň H.</li> </ul> <p>Ucc je napájacie napätie obvodu.</p> <p><strong>Poznámka k pull-up odporom:</strong> V prípade, ak je príslušný vývod v režime vstup, napr. PD7 - pripomínam, že režim definuje obsah registra DDRx (DDRD7 = log.0) - potom úroveň na jeho vstupe je definovaná privedeným napätím. Čo ale v prípade, ak na vstup nie je privedené žiadne napätie? Potom je takýto vstup v takzvanej neurčitej úrovni. V závislosti od šumu okolia môže byť interpretovaný ako L, ale aj ako H. Aby sme sa vyhli takémuto náhodnému správaniu je v štruktúre obvodu integrovaný pull-up odpor, ktorého nastavením pripojíme vývod na napätie Ucc, čím definujeme úroveň H. V prípade MCU Atmel328 je pre zapnutie pull-up odporu potrebné nastaviť hodnotu príslušného bitu registra PORTD na hodnotu log.1. </p> </div> <p><img alt=img src=../images/mcuVVreg.jpg></p> <p>Tento náš prvý projekt je skutočne veľmi jednoduchý a ani sa nevyznačuje objektovým prístupom. Pokúsme sa teraz upraviť náš projekt tak, aby viac zodpovedal objektovému programovaniu.</p> <h3 id=objektovy-pristup>Objektový prístup<a class=headerlink href=#objektovy-pristup title="Permanent link">&para;</a></h3> <p>Tento náš prvý projekt je skutočne veľmi jednoduchý a ani sa nevyznačuje objektovým prístupom. Pokúsme sa teraz upraviť náš projekt tak, aby viac zodpovedal objektovému programovaniu.</p> <p>V prvom kroku sa pokúsime vytvoriť triedu s názvom <code>RGB_LED</code>. V Exploreri klikneme pravým tlačidlom na názov projektu. Objaví sa nám ponuka, z ktorej vyberieme položku „add“. Po jej zvolení sa objaví ďalšia ponuka, v ktorej vyberieme položku „Add New Class“. Po jej zvolení sa dostaneme do ďalšieho okna, v ktorom zvolíme typ triedy a vypíšeme je názov „RGB_LED“.</p> <p><img alt=img src=../images/addClass.jpg></p> <p><img alt=img src=../images/newclass.jpg#center></p> <blockquote> <p>Súborová štruktúra projektu</p> <div class=highlight><pre><span></span><code>.
├── BOARD_AVR.h
├── main.cpp
├── RGB_LED.cpp
└── RGB_LED.h
</code></pre></div> </blockquote> <p>Takto vyzerá hlavičkový súbor triedy <code>RGB_LED</code>. Obsahuje len deklaráciu triedy a jej členov.</p> <blockquote> <p>RGB_LED.h</p> <div class=highlight><pre><span></span><code><span class=cm>/* </span>
<span class=cm>* RGB_LED.h</span>
<span class=cm>*</span>
<span class=cm>* Created: 25.2.2020 12:02:59</span>
<span class=cm>* Author: Juraj</span>
<span class=cm>*/</span>

<span class=cp>#ifndef __RGB_LED_H__</span>
<span class=cp>#define __RGB_LED_H__</span>

<span class=cp>#include</span> <span class=cpf>&quot;BOARD_AVR.h&quot;</span><span class=cp></span>

<span class=k>class</span> <span class=nc>RGB_LED</span>
<span class=p>{</span>

<span class=c1>//variables</span>
<span class=k>public</span><span class=o>:</span>
<span class=k>protected</span><span class=o>:</span>
<span class=k>private</span><span class=o>:</span>

<span class=c1>//functions</span>
<span class=k>public</span><span class=o>:</span>
   <span class=n>RGB_LED</span><span class=p>();</span>
   <span class=o>~</span><span class=n>RGB_LED</span><span class=p>();</span>

<span class=kt>void</span> <span class=nf>zhasni_vsetko_RGB</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>
<span class=kt>void</span> <span class=nf>zasviet_RGB</span><span class=p>(</span><span class=kt>bool</span><span class=p>,</span> <span class=kt>bool</span><span class=p>,</span> <span class=kt>bool</span><span class=p>);</span>

<span class=k>protected</span><span class=o>:</span>
<span class=k>private</span><span class=o>:</span>
   <span class=n>RGB_LED</span><span class=p>(</span> <span class=k>const</span> <span class=n>RGB_LED</span> <span class=o>&amp;</span><span class=n>c</span> <span class=p>);</span>
   <span class=n>RGB_LED</span><span class=o>&amp;</span> <span class=k>operator</span><span class=o>=</span><span class=p>(</span> <span class=k>const</span> <span class=n>RGB_LED</span> <span class=o>&amp;</span><span class=n>c</span> <span class=p>);</span>

<span class=p>};</span> <span class=c1>//RGB_LED</span>
<span class=cp>#endif </span><span class=c1>//__RGB_LED_H__</span>
</code></pre></div> </blockquote> <p>Takto vyzerá definičný súbor triedy <code>RGB_LED</code>. V konštruktore sa nastavuje smer použitých vývodov (alokujú sa používané zdroje). V deštruktore sa tieto majú uvoľniť pre prípadné použitie inými inštanciami. V tomto špecifickom prípade to nie je ale potrebné. V ďalšom sú definované len dve funkcie/metódy s názvami „Zhasni_vsetko_RGB“ bez parametrov a „Zasvieť RGB“ s troma parametrami, ktorých význam je zrejmý. Obe funkcie nič nevracajú, sú deklarované ako „void“.</p> <blockquote> <p>RGB_LED.cpp</p> <div class=highlight><pre><span></span><code><span class=cm>/* </span>
<span class=cm>* RGB_LED.cpp</span>
<span class=cm>*</span>
<span class=cm>* Created: 25.2.2020 12:02:58</span>
<span class=cm>* Author: Juraj</span>
<span class=cm>*/</span>
<span class=cp>#include</span> <span class=cpf>&quot;RGB_LED.h&quot;</span><span class=cp></span>
<span class=c1>// default constructor</span>
<span class=n>RGB_LED</span><span class=o>::</span><span class=n>RGB_LED</span><span class=p>()</span>
<span class=p>{</span>
  <span class=n>sbi</span><span class=p>(</span><span class=n>DDRD</span><span class=p>,</span><span class=n>LED_RED</span><span class=p>);</span>   <span class=c1>//DDRD</span>
  <span class=n>sbi</span><span class=p>(</span><span class=n>DDRD</span><span class=p>,</span><span class=n>LED_GREEN</span><span class=p>);</span>
  <span class=n>sbi</span><span class=p>(</span><span class=n>DDRD</span><span class=p>,</span><span class=n>LED_BLUE</span><span class=p>);</span>
<span class=p>}</span> <span class=c1>//RGB_LED</span>

<span class=c1>// default destructor</span>
<span class=n>RGB_LED</span><span class=o>::~</span><span class=n>RGB_LED</span><span class=p>()</span>
<span class=p>{</span>
<span class=p>}</span> <span class=c1>//~RGB_LED</span>


<span class=kt>void</span> <span class=n>RGB_LED</span><span class=o>::</span><span class=n>zhasni_vsetko_RGB</span><span class=p>()</span>
<span class=p>{</span>
  <span class=n>sbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span><span class=n>LED_RED</span><span class=p>);</span>
  <span class=n>sbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span><span class=n>LED_GREEN</span><span class=p>);</span>
  <span class=n>sbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span><span class=n>LED_BLUE</span><span class=p>);</span>
<span class=p>}</span>

<span class=kt>void</span> <span class=n>RGB_LED</span><span class=o>::</span><span class=n>zasviet_RGB</span><span class=p>(</span><span class=kt>bool</span> <span class=n>r</span><span class=p>,</span> <span class=kt>bool</span> <span class=n>g</span><span class=p>,</span> <span class=kt>bool</span> <span class=n>b</span><span class=p>)</span>
<span class=p>{</span>
  <span class=k>this</span><span class=o>-&gt;</span><span class=n>zhasni_vsetko_RGB</span><span class=p>();</span>
  <span class=k>if</span><span class=p>(</span><span class=n>r</span><span class=o>==</span><span class=nb>true</span><span class=p>)</span> <span class=n>cbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span><span class=n>LED_RED</span><span class=p>);</span>
  <span class=k>if</span><span class=p>(</span><span class=n>g</span><span class=o>==</span><span class=nb>true</span><span class=p>)</span> <span class=n>cbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span><span class=n>LED_GREEN</span><span class=p>);</span>
  <span class=k>if</span><span class=p>(</span><span class=n>b</span><span class=o>==</span><span class=nb>true</span><span class=p>)</span> <span class=n>cbi</span><span class=p>(</span><span class=n>PORTD</span><span class=p>,</span><span class=n>LED_BLUE</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div> </blockquote> <p>Aby sme mohli používať triedu „RGB_LED“ v súbore <code>main.cpp</code>, musíme použiť direktívu <code>#include "RGB_LED.h"</code> a definovať objekt typu RGB_LED. Potom už nič nebráni vytvoriť program podľa zadania.</p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label> <a href=.. title=Úvod class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Späť </span> Úvod </div> </div> </a> <a href=../pr2/ title="Príklad 2 „RGB_AKU“" class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Ďalej </span> Príklad 2 „RGB_AKU“ </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Juraj Miček </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/friktk target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=../assets/javascripts/vendor.83fe6e3c.min.js></script> <script src=../assets/javascripts/bundle.7e1cb91c.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Kop\u00edrova\u0165 do schr\u00e1nky", "clipboard.copied": "Skop\u00edrovan\u00e9 do schr\u00e1nky", "search.config.lang": "", "search.config.pipeline": "", "search.config.separator": "", "search.result.placeholder": "Pre vyh\u013ead\u00e1vanie za\u010dni p\u00edsa\u0165", "search.result.none": "\u017diadne vyhovuj\u00face dokumenty", "search.result.one": "Vyhovuj\u00faci dokument: 1", "search.result.other": "Vyhovuj\u00face dokumenty: #"}</script> <script>
        app = initialize({
          base: "..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>